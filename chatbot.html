<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Interview Chatbot</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js"></script>
  <script src="js/chatbot.js"></script>
</head>
<body class="bg-gray-900 text-gray-100 p-4">
  <div class="max-w-xl mx-auto">
    <button id="start" class="bg-blue-500 px-4 py-2 rounded">Start</button>
    <div id="quiz" class="mt-4 hidden">
      <div id="qtext" class="mb-4 font-semibold"></div>
      <ul id="options" class="space-y-2"></ul>
      <div id="explanation" class="mt-4 hidden"></div>
      <button id="next" class="mt-4 bg-green-600 px-4 py-2 rounded hidden">Next</button>
    </div>
  </div>
  <script>
    $(function(){
      let current;
      async function load(){
        $('#explanation').addClass('hidden').text('');
        $('#next').addClass('hidden');
        current = await ChatBot.fetchQuestion();
        $('#qtext').text(current.question);
        $('#options').empty();
        current.choices.forEach((c,i)=>{
          $('<li></li>').append(
            $('<button></button>')
              .addClass('w-full text-left px-4 py-2 bg-gray-800 rounded hover:bg-gray-700')
              .text(String.fromCharCode(65+i)+'. '+c)
              .on('click',()=>select(i))
          ).appendTo('#options');
        });
        $('#quiz').removeClass('hidden');
      }
      function select(i){
        $('#options button').attr('disabled',true);
        $('#options button').eq(current.answer).addClass('bg-green-700');
        if(i!==current.answer) $('#options button').eq(i).addClass('bg-red-700');
        $('#explanation').removeClass('hidden').text(current.explanation);
        $('#next').removeClass('hidden');
      }
      $('#start').on('click', load);
      $('#next').on('click', load);
    });
  </script>
</body>
</html>
